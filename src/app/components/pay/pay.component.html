<ion-header no-border>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="closeModal('pago_no_efectuado')">
        <ion-icon slot="icon-only" name="close" style="color:#444"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>

  <div style="margin-left:20px;color:#444;font-weight:550">
    Un rider ha aceptado tu pedido!
  </div>

  <div padding style="margin-left:15px;width:100%;display:flex;align-items:center;">

    <div style="position:relative">
      <img [src]="rider.img.url" style="width:80px;height:80px;border-radius:50%;object-fit:cover">
      <div class="burbuja burbujaActiva" style="position:absolute;bottom:0px;right:-30px">
        <img *ngIf="rider.vehiculo == 'Moto'" src="assets/moto.png" class="transporte">
        <img *ngIf="rider.vehiculo == 'Bicicleta'" src="assets/bici.png" class="transporte">
      </div>
    </div>

    <div style="margin-left:40px;font-size:16px;font-weight:600;text-transform:capitalize">
      {{ rider.nombre }}
      <div style="display:flex;align-items:center">
        <ion-icon *ngIf="rider.stats.startsAvg >= 1" name="star" class="start"></ion-icon>
        <ion-icon *ngIf="rider.stats.startsAvg == 1.5" name="star-half" class="start"></ion-icon>
        <ion-icon *ngIf="rider.stats.startsAvg >= 2" name="star" class="start"></ion-icon>
        <ion-icon *ngIf="rider.stats.startsAvg == 2.5" name="star-half" class="start"></ion-icon>
        <ion-icon *ngIf="rider.stats.startsAvg >= 3" name="star" class="start"></ion-icon>
        <ion-icon *ngIf="rider.stats.startsAvg == 3.5" name="star-half" class="start"></ion-icon>
        <ion-icon *ngIf="rider.stats.startsAvg >= 4" name="star" class="start"></ion-icon>
        <ion-icon *ngIf="rider.stats.startsAvg == 4.5" name="star-half" class="start"></ion-icon>
        <ion-icon *ngIf="rider?.stats.startsAvg >= 5" name="star" class="start"></ion-icon>
        ({{ rider?.stats.startsAvg }})
      </div>
    </div>

  </div>


  <div padding>
    <div style="border:1px solid #eee">
      <ion-item lines="none">
        <div style="color:#444;font-size:16px">
          Distancia:
        </div>
        <div slot="end" style="color:#444;font-size:16px">
          {{pedido.distancia / 1000}} km
        </div>
      </ion-item>

      <ion-item lines="none">
        <div style="color:#444;font-size:16px">
          Costo del servicio:
        </div>
        <div *ngIf="!cuponData.ok" slot="end" style="font-size:18px;color:#0cd1e8;font-weight:600">
          ${{ monto }} CLP
        </div>
        <div *ngIf="cuponData.ok" slot="end" style="font-size:18px;color:#0cd1e8;font-weight:600">
          <span style="font-size:14px;text-decoration: line-through;color:#999">
            ${{monto}}
          </span>
          ${{ precio_descuento }} CLP
        </div>
      </ion-item>
    </div>


    <ion-item *ngIf="usuario.role == 'USUARIO_ROLE'" lines="none">
      <div style="color:#444;font-size:16px">
        MÃ©todo de pago:
      </div>
    </ion-item>

    <ion-item *ngIf="usuario.role == 'USUARIO_ROLE'" (click)="togglePay('Tarjeta')" lines="none">
      <ion-icon slot="start" name="card" style="color:#666"></ion-icon>
      <ion-label>Tarjeta</ion-label>
      <ion-icon *ngIf="metodoPago == 'Tarjeta'" slot="end" name="checkmark" style="color:limegreen"></ion-icon>
      <ion-icon *ngIf="metodoPago != 'Tarjeta'" slot="end" name="checkmark" style="color:white"></ion-icon>
    </ion-item>

    <ion-item *ngIf="usuario.role == 'USUARIO_ROLE'" (click)="togglePay('Efectivo')" lines="none">
      <ion-icon slot="start" name="cash" style="color:#666"></ion-icon>
      <ion-label>Efectivo</ion-label>
      <ion-icon *ngIf="metodoPago == 'Efectivo'" slot="end" name="checkmark" style="color:limegreen"></ion-icon>
      <ion-icon *ngIf="metodoPago != 'Efectivo'" slot="end" name="checkmark" style="color:white"></ion-icon>
    </ion-item>

    <!-- <ion-item *ngIf="usuario.role == 'EMPRESA_ROLE'" lines="none">
      <ion-icon slot="start" name="card" style="color:#666"></ion-icon>
      <ion-label>Tarjeta</ion-label>
      <ion-icon slot="end" name="checkmark-circle" style="color:darkorange"></ion-icon>
    </ion-item> -->

    <ion-item *ngIf="cuponData.ok" lines="none">
      <div style="color:#444;font-size:16px">
        Promociones:
      </div>
    </ion-item>

    <div *ngIf="cuponData.ok"
      style="padding:10px;background:orange;width:100%;border-radius:5px;display:flex;align-items:center;justify-content:space-between">

      <div>
        <div style="font-size:17px;font-weight:600;color:white">
          {{cuponData.cupon.descuento}}% de descuento
        </div>
        <div style="color:#eee;font-size:14px">
          <div>
            Valido por 1 pedido
          </div>
          <div>
            Vence: {{cuponData.cupon.valido_hasta}}
          </div>
        </div>
      </div>

      <ion-icon name="checkmark" style="color:white;font-size:22px"></ion-icon>

    </div>

  </div>


</ion-content>


<ion-footer style="background:white">
  <div padding>
    <ion-button (click)="pagar()" mode="ios" expand="block" color="secondary">
      <div style="font-size:20px;font-weight:600">
        Confirmar y pagar
      </div>
      <!-- <ion-icon slot="end" name="ios-arrow-dropright-circle" style="color:#fff;font-size:30px"></ion-icon> -->
    </ion-button>
  </div>
</ion-footer>


<div *ngIf="isLoading"
  style="z-index:999;position:fixed;top:0px;left:0px;height:100%;width:100%;display:flex;align-items:center;justify-content:center;background:rgb(34, 34, 34, 0.5)">
  <div style="box-shadow: 0 0 20px rgba(68, 68, 68, 0.75);padding:40px;border-radius:3px;background:white;">
    <div style="width:100%;display:flex;align-items:center">
      <ion-spinner color="secondary"></ion-spinner>
      <div style="margin-left:20px;font-size:17.5px;margin-right:10px">
        Espere...
      </div>
    </div>
  </div>
</div>